# 手動端對端測試腳本

此腳本覆蓋離線快取、背景上傳重試與審核記錄儲存等關鍵場景。建議在真機或模擬器上依序執行。

## 測試前置
1. 建立 Cloud Run 帳號並確認 `.env` 已填入 `CLOUD_RUN_*` 端點與 `GEMINI_API_KEY`。
2. 確認測試帳號已在後端建立至少一個未完成的巡檢工作。
3. 準備 2~3 張測試照片（可放在相簿）。

## 測試步驟

### 1. 登入與任務載入
- 開啟 App，進入 **步驟 1**。
- 輸入有效帳號密碼，點擊「登入並載入任務」。
- 驗證：登入成功後，應顯示派發的任務列表。

### 2. 任務選擇與檢查表快取
- 點選任務卡片的「開始」。
- 驗證：檢查點列表顯示，並且重新啟動 App 後依然存在（代表快取成功）。

### 3. 離線拍攝與背景佇列
- 關閉裝置網路。
- 在 **步驟 2** 為兩個檢查點拍照。
- 驗證：每個項目顯示「等待網路連線後自動上傳」，且 **步驟 1** 頁首顯示待同步張數。

### 4. 網路恢復與自動重試
- 開啟網路，點擊 **步驟 2** 的「同步 X 張照片」。
- 驗證：同步完成後，提示消失並在 **步驟 3** 出現待審核卡片。

### 5. 審核與儲存
- 在 **步驟 3** 開啟每張卡片，檢查 AI 結果可手動編輯。
- 點擊「確認記錄」，確認資料被寫入 **步驟 4** 的檢測記錄表格。

### 6. 報告生成
- 在 **步驟 4** 點擊「產生總結報告」，確認內容產生並可複製。

### 7. 錯誤回退驗證（選擇性）
- 重複步驟 3，但在同步時刻意關閉網路並觀察待上傳佇列重試次數 ≥ 3 時是否觸發 Gemini 後備分析。

> 若任一步驟失敗，請記錄螢幕截圖與 `flutter logs` 內容，並回報 Cloud Run 日誌。
